<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Catálogo de Productos</title>

  <!-- Agrega los estilos y scripts de Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../JavaScript/main.js" type="module"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AQHb_kWVVp939vsNMtjykIhYmktL-OShdK7z_cBatgDZhq9y4kLV5omKE8rbhJ-u_trvLnrjZhbjFaFd&currency=USD"></script>
</head>
  

  <style>

  body {
    background-image: url('/ProyectoFinal_AplicacionesWeb/img/fondo1.jpg');
    background-attachment: fixed;
    background-size: cover;
    background-position: center;
    transition: background-position 0.5s ease-in-out;
  }

  body.scrolled {
    background-position: center 50px; /* Ajusta según tu necesidad */
  }

    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color:seagreen;
      border: 1px solid #ccc;
      z-index: 1;
      width: 20%;
      border-radius: 15px;
       color:lightgray;
    }
    .popup1 {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 200px;
    border: 50px solid #405e47;
    background: #fff;
    z-index: 1000;
  }
  .cerrar-popup1 {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
}
.contenido-popup {
    /* Estilo del contenido del pop-up */
}


    .producto-container {
    text-align: center;
    margin-bottom: 35px;
    display: inline-block;
    width: 30%;
    margin-right: 1.2%;
    margin-left: 2.1%;
    font-size: xx-small;
    border: 1px solid #405e47; /* Añade esta línea para el borde */
    background-color: rgba(199, 255, 171, 0.35);
    padding: 10px; /* Opcional: Agrega relleno para separar el borde del contenido */
  }
  .producto-container img {
    max-width: 30%;
    height: auto;
    border: 2px solid #000000; /* Añade esta línea para el borde de la imagen */
  }

    .button-container {
      align-items:flex-start;
    margin-top: 60px;
    }
  .button-container button {
    margin: 2 auto;
    display: block;
    background-color: #405e47 !important;
    }
  .navbar,
.navbar a {
  background-color: rgba(45, 73, 49, 0.897)!important; /* Ajusta el valor de opacidad según tu necesidad */
  color:rgba(144, 183, 157, 0.897) ; /* Cambia el color blanco (#ffffff) al que desees */
} 
  .navbar.scrolled {
    background-color: rgba(138,221,45,0.2) !important; /* Ajusta según tu necesidad */
  }
  .navbar-brand img {
    max-width: 100px; /* Ajusta según tu necesidad */
    margin: 0 auto;
    display: block;
  }

h1,
h2,
h3,
h4,
h5,
h6 {
  color: rgb(255, 255, 255);
}
 .pagination {
    margin-top: 20px;
  }



  .pagination li a {
    padding: 8px 12px;
    background-color: #266d37;
    color: #000000;
    text-decoration: none;
    border-radius: 4px;
  }

  .pagination li.active a {
    background-color: #fff;
    color: #405e47;
  }

  </style>

      
</head>
<body>

     <!-- Empieza la nav bar -->
     <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">VerdeVida</a>
       
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item logged-out">
              <a
                class="nav-link"
                href="#"
                data-bs-toggle="modal"
                data-bs-target="#signinModal"
                >Sign In</a
              >
            </li>
            <li class="nav-item logged-out">
              <a
                class="nav-link"
                href="#"
                data-bs-toggle="modal"
                data-bs-target="#signupModal"
                >Sign Up</a
              >
            </li>
       
            <li class="nav-item logged-in">
              <a class="nav-link" href="#" id="logout">Log Out</a>
            </li> 
             
          </ul>
          
        </div>
      </div>
      

      <li class="nav-item logged-in">
        <!-- Mensaje de carrito movido fuera del pop-up -->
        
        <div id="popup1" class="popup1">
          <span class="cerrar-popup1" onclick="cerrarPopup()">&times;</span>
          <div id="contenido-popup" class="contenido-popup">
            <!-- Resto del código del pop-up del carrito -->
            <div id="total-carrito-popup"></div>
            <div id="paypal-popup-container" style="width: 200px; height: 50px;"></div>
          </div>
        </div>
      
        <div id="carrito-compras" class="carrito-compras">
          <img id="carrito-imagen" src="https://images.vexels.com/media/users/3/200097/isolated/preview/942820836246f08c2d6be20a45a84139-carrinho-de-compras-icon-carrinho-de-compras-by-vexels.png" alt="Carrito de Compras" height="50" style="cursor: pointer;" onclick="mostrarPopup1()">
        </div>
      </li>
      </ul>
     
      </div>
      </nav>
      <div id="mensaje-global" style="display: none;"></div>

<script>
  var carrito = []; // Array para almacenar los productos en el carrito
  
  // Agrega el código de PayPal aquí
  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: calcularTotalCarrito() // Utiliza una función para obtener el total del carrito
          }
        }]
      });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
        alert('Pago completado por ' + details.payer.name.given_name);
        // Aquí puedes agregar lógica adicional después de que se complete el pago
        vaciarCarrito(); // Vaciar el carrito después de completar el pago
        cerrarPopup(); // Cerrar el pop-up después de completar el pago
      });
    }
  }).render('#paypal-popup-container');
  
  function mostrarPopup1() {
    var popup = document.getElementById("popup1");
    popup.style.display = "block";
    // Actualiza la interfaz del pop-up del carrito al mostrarse
    actualizarInterfazCarritoPopup();
  }
  
  function cerrarPopup() {
    var popup = document.getElementById("popup1");
    popup.style.display = "none";
  }
  
  function calcularTotalCarrito() {
    // Lógica para calcular el total del carrito
    var total = 0;
    carrito.forEach(producto => {
      total += producto.precio;
    });
    return total.toFixed(2);
  }
  
  function vaciarCarrito() {
    // Lógica para vaciar el carrito
    carrito = [];
  }
  
  // Función para agregar productos al carrito
  function agregarAlCarrito(producto) {
    carrito.push(producto);
    // Actualizar la interfaz del pop-up del carrito al agregar productos
    mostrarMensajePopup('Producto agregado al carrito: ' + producto.nombre);
    actualizarInterfazCarritoPopup();
  }
  
  function mostrarMensajePopup(mensaje) {
    // Actualizar el contenido del mensaje en el lugar donde deseas mostrarlo
    var mensajeGlobalElement = document.getElementById("mensaje-global");
    mensajeGlobalElement.innerHTML = mensaje;
  
    // Mostrar el mensaje
    mensajeGlobalElement.style.display = "block";
  
    // Ocultar el mensaje después de 3 segundos (puedes ajustar el tiempo según tus necesidades)
    setTimeout(function() {
      mensajeGlobalElement.style.display = "none";
    }, 3000);
  }
  
  function actualizarInterfazCarritoPopup() {
    var carritoPopupDiv = document.getElementById('total-carrito-popup');
    var totalPopup = 0;
  
    carritoPopupDiv.innerHTML = '';
  
    carrito.forEach(producto => {
      totalPopup += producto.precio;
      carritoPopupDiv.innerHTML += `
        <p>${producto.nombre} - $${producto.precio.toFixed(2)}</p>
      `;
    });
  
    carritoPopupDiv.innerHTML += `<strong>Total: $${totalPopup.toFixed(2)}</strong>`;
  }
</script>


            
  
     </nav>
    <!-- termina la nav bar. -->

    <div id="filtroCategorias">
          <br>
      <button class="btn btn-success" onclick="filtrarPorCategoria(null)">Todos</button>
      <button class="btn btn-success" onclick="filtrarPorCategoria('Decoracion')">Decoracion</button>
      <button class="btn btn-success" onclick="filtrarPorCategoria('Herramientas')">Herramientas</button>
      <button class="btn btn-success" onclick="filtrarPorCategoria('Macetas')">Macetas</button>
      <button class="btn btn-success" onclick="filtrarPorCategoria('Plantas')">Plantas</button>
      <!-- Otros botones de categoría... -->
    </div>
 <br>
 <br>

  <div id="catalogo" class="row"></div>
  
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center" id="pagination"></ul>
  </nav>

<div id="popup" class="popup">
  <div id="carouselExample" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner" id="carouselInner"></div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div id="detallesContainer">
    <h3>Detalles del Producto</h3>
    <p id="detallesTexto"></p>

    <h3>Precio</h3>
    <p id="precioTexto"></p>
    <p id="descripcionTexto"></p>
    
    <button id="cerrarPopup" class="btn btn-danger">Cerrar</button>
  </div>
</div>

   <div
   class="modal fade"
   id="signinModal"
   tabindex="-1"
   aria-labelledby="exampleModalLabel"
   aria-hidden="true"
 >
   <div class="modal-dialog">
     <div class="modal-content">
       <div class="modal-header">
         <h1 class="modal-title fs-5" id="exampleModalLabel">Sign In</h1>
         <button
           type="button"
           class="btn-close"
           data-bs-dismiss="modal"
           aria-label="Close"
         ></button>
       </div>
       <div class="modal-body">
         <form id="login-form">
           <label for="email">Email:</label>
           <input
             type="email"
             class="form-control mb-3"
             id="login-email"
             placeholder="Email"
             required
           />

           <label for="password">Password:</label>
           <input
             type="password"
             class="form-control mb-3"
             id="login-password"
             placeholder="******"
             required
           />

           <button type="submit" class="btn btn-success w-100 mb-4">
             Log in
           </button>
         </form>

         <button
           type="button"
           id="googleLogin"
           class="btn btn-info w-100 mb-4"
         >
           Google
         </button>
         <div class="container text-center">
           <a href="./HTML/forgotPassword.html" class="" id=""
             >Did you forget the password?</a
           >
           <br />
           <a href="" class=""
             >You still do not have an account?</a
           >
         </div>
       </div>
     </div>
   </div>
 </div>

 <div
   class="modal fade"
   id="signupModal"
   tabindex="-1"
   aria-labelledby="exampleModalLabel"
   aria-hidden="true"
 >
   <div class="modal-dialog">
     <div class="modal-content">
       <div class="modal-header">
         <h1 class="modal-title fs-5" id="exampleModalLabel">Sign Up</h1>
         <button
           type="button"
           class="btn-close"
           data-bs-dismiss="modal"
           aria-label="Close"
         ></button>
       </div>
       <div class="modal-body">
         <form id="signup-form">
           <label for="email">Email:</label>
           <input
             id="signup-email"
             type="email"
             class="form-control mb-3"
             placeholder="Email"
             required
           />

           <label for="password">Password:</label>
           <input
             id="signup-password"
             type="password"
             class="form-control mb-3"
             placeholder="******"
             required
           />

           <button type="submit" class="btn btn-success">Register</button>
         </form>
       </div>
     </div>
   </div>
 </div>


  <script>
   let productos;
    const productosPorPagina = 12;
    let paginaActual = 1;

    fetch('productos.json')
      .then(response => response.json())
      .then(data => {
        productos = data;
        mostrarProductos(paginaActual);
        mostrarPaginacion();
      })
      .catch(error => console.error('Error al cargar el archivo JSON:', error));

      function mostrarProductos(pagina, categoriaFiltro = null) {
  const catalogoDiv = document.getElementById('catalogo');
  catalogoDiv.innerHTML = '';

  const inicio = (pagina - 1) * productosPorPagina;
  const fin = inicio + productosPorPagina;
  let productosFiltrados = productos.slice(inicio, fin);
  if (categoriaFiltro) {
    productosFiltrados = productosFiltrados.filter(producto => producto.categoria === categoriaFiltro);
  }

  productosFiltrados.forEach(producto => {
  catalogoDiv.innerHTML += `
    <div class="producto-container">
      <h2>${producto.nombre}</h2>
      <img src="${producto.imagen}" alt="${producto.nombre}" class="img-fluid">
      <br> 
      <br>
      <button class="btn btn-success" onclick="mostrarPopup(${producto.id})">Ver más</button>
      <button class="btn btn-success btn-agregar-carrito" data-producto-id="${producto.id}">🛒</button>
    </div>
  `;
});
}

    function mostrarPaginacion() {
      const totalPaginas = Math.ceil(productos.length / productosPorPagina);
      const paginationUl = document.getElementById('pagination');
      paginationUl.innerHTML = '';

      for (let i = 1; i <= totalPaginas; i++) {
        const li = document.createElement('li');
        li.classList.add('page-item');
        const a = document.createElement('a');
        a.classList.add('page-link');
        a.href = '#';
        a.textContent = i;
        a.addEventListener('click', function() {
          cambiarPagina(i);
        });
        li.appendChild(a);
        paginationUl.appendChild(li);
      }
    }

    function filtrarPorCategoria(categoria) {
  mostrarProductos(paginaActual, categoria);
  mostrarPaginacion(); // Actualizar paginación después de aplicar el filtro
}

      // Función para mostrar el popup con más información
      function mostrarPopup(id) {
  const popupDiv = document.getElementById('popup');
  const carouselInner = document.getElementById('carouselInner');
  const detallesTexto = document.getElementById('detallesTexto');
  const precioTexto = document.getElementById('precioTexto');
  const descripcionTexto = document.getElementById('descripcionTexto');
  const carritoContainer = document.getElementById('carritoContainer');
  const producto = obtenerProductoPorId(id);

  if (!producto) {
    console.error('Producto no encontrado');
    return;
  }


  // Limpiar el contenido previo del carrusel
  carouselInner.innerHTML = '';
  detallesTexto.textContent = '';
  precioTexto.textContent = '';
  descripcionTexto.textContent = '';

  // Agregar imágenes al carrusel
  producto.imagenes.forEach((imagen, index) => {
    const activeClass = index === 0 ? 'active' : '';
    carouselInner.innerHTML += `
      <div class="carousel-item ${activeClass}">
        <img src="${imagen}" class="d-block w-100" alt="Imagen ${index + 1}">
      </div>
    `;
  });

  // Actualizar el contenido de los elementos de texto
  detallesTexto.textContent = producto.detalles;
  precioTexto.textContent = `$${producto.precio.toFixed(2)}`; // Formatear el precio
  descripcionTexto.textContent = producto.descripcion;

  // Mostrar el popup
  popupDiv.style.display = 'block';
}


      // Función para obtener el producto por su ID
       function obtenerProductoPorId(id) {
      // Buscar el producto en el array de productos por su ID
      const productoEncontrado = productos.find(producto => producto.id === id);
      // Verificar si se encontró el producto
      if (productoEncontrado) {
        return productoEncontrado;
      } else {
        console.error('Producto no encontrado');
        return null;
      }
    }

    function cambiarPagina(pagina) {
      paginaActual = pagina;
      mostrarProductos(pagina);
    } 


    // Cerrar el popup al hacer clic en el botón "Cerrar"
      document.getElementById('cerrarPopup').addEventListener('click', function() {
      document.getElementById('popup').style.display = 'none';
    });
    function actualizarInterfazCarrito() {
  const carritoProductosDiv = document.getElementById('carrito-productos');
  const totalDiv = document.getElementById('total-carrito');

  // Verifica si los elementos existen antes de intentar acceder a sus propiedades
  if (!carritoProductosDiv || !totalDiv) {
    console.error('Al menos uno de los elementos no se encontró en el DOM');
    return;
  }

  let total = 0;

  carritoProductosDiv.innerHTML = '';

  carrito.forEach(producto => {
    total += producto.precio;
    carritoProductosDiv.innerHTML += `
      <p>${producto.nombre} - $${producto.precio.toFixed(2)}
        <button class="btn btn-danger btn-eliminar-producto" data-producto-id="${producto.id}">Eliminar</button>
      </p>
    `;
  });

  // Actualiza el total al final
  totalDiv.textContent = `Total: $${total.toFixed(2)}`;
}
  </script>

<script>
  document.addEventListener('scroll', function () {
    if (window.scrollY > 50) {
      document.body.classList.add('scrolled');
    } else {
      document.body.classList.remove('scrolled');
    }
  });
</script>

<script>
  document.addEventListener('scroll', function () {
    if (window.scrollY > 50) {
      document.querySelector('.navbar').classList.add('scrolled');
    } else {
      document.querySelector('.navbar').classList.remove('scrolled');
    }
  });
</script>

<script src="../JavaScript/main.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

<script src="../Productos/productos.json"></script>

<script src="../CarritoCompras/paypal2.js"></script>
<script src="./busqueda.js" type="module"></script>
<script src="../Productos/carrito.js" type="module"></script>

</body>
</html>




